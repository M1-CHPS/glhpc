
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
      
      
        <link rel="prev" href="../lab4/">
      
      
        <link rel="next" href="../lab6/">
      
      
      <link rel="icon" href="../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.6.1, mkdocs-material-9.6.19">
    
    
      
        <title>Lab 5 - Experimental Methodology and Scientific Reporting - GLHPC - Génie Logiciel pour le Calcul Haute Performance et l'Intelligence Artificielle</title>
      
    
    
      <link rel="stylesheet" href="../assets/stylesheets/main.7e37652d.min.css">
      
        
        <link rel="stylesheet" href="../assets/stylesheets/palette.06af60db.min.css">
      
      


    
    
      
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
      <link rel="stylesheet" href="../stylesheets/extra.css">
    
    <script>__md_scope=new URL("..",location),__md_hash=e=>[...e].reduce(((e,_)=>(e<<5)-e+_.charCodeAt(0)),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
    
  </head>
  
  
    
    
      
    
    
    
    
    <body dir="ltr" data-md-color-scheme="default" data-md-color-primary="deep-purple" data-md-color-accent="red">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

  

<header class="md-header md-header--shadow md-header--lifted" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href=".." title="GLHPC - Génie Logiciel pour le Calcul Haute Performance et l&#39;Intelligence Artificielle" class="md-header__button md-logo" aria-label="GLHPC - Génie Logiciel pour le Calcul Haute Performance et l'Intelligence Artificielle" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54"/></svg>

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3zm0 5h18v2H3zm0 5h18v2H3z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            GLHPC - Génie Logiciel pour le Calcul Haute Performance et l'Intelligence Artificielle
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              Lab 5 - Experimental Methodology and Scientific Reporting
            
          </span>
        </div>
      </div>
    </div>
    
      
        <form class="md-header__option" data-md-component="palette">
  
    
    
    
    <input class="md-option" data-md-color-media="" data-md-color-scheme="default" data-md-color-primary="deep-purple" data-md-color-accent="red"  aria-label="Switch to dark mode"  type="radio" name="__palette" id="__palette_0">
    
      <label class="md-header__button md-icon" title="Switch to dark mode" for="__palette_1" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a4 4 0 0 0-4 4 4 4 0 0 0 4 4 4 4 0 0 0 4-4 4 4 0 0 0-4-4m0 10a6 6 0 0 1-6-6 6 6 0 0 1 6-6 6 6 0 0 1 6 6 6 6 0 0 1-6 6m8-9.31V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20v-4.69L23.31 12z"/></svg>
      </label>
    
  
    
    
    
    <input class="md-option" data-md-color-media="" data-md-color-scheme="slate" data-md-color-primary="deep-purple" data-md-color-accent="red"  aria-label="Switch to light mode"  type="radio" name="__palette" id="__palette_1">
    
      <label class="md-header__button md-icon" title="Switch to light mode" for="__palette_0" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 18c-.89 0-1.74-.2-2.5-.55C11.56 16.5 13 14.42 13 12s-1.44-4.5-3.5-5.45C10.26 6.2 11.11 6 12 6a6 6 0 0 1 6 6 6 6 0 0 1-6 6m8-9.31V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20v-4.69L23.31 12z"/></svg>
      </label>
    
  
</form>
      
    
    
      <script>var palette=__md_get("__palette");if(palette&&palette.color){if("(prefers-color-scheme)"===palette.color.media){var media=matchMedia("(prefers-color-scheme: light)"),input=document.querySelector(media.matches?"[data-md-color-media='(prefers-color-scheme: light)']":"[data-md-color-media='(prefers-color-scheme: dark)']");palette.color.media=input.getAttribute("data-md-color-media"),palette.color.scheme=input.getAttribute("data-md-color-scheme"),palette.color.primary=input.getAttribute("data-md-color-primary"),palette.color.accent=input.getAttribute("data-md-color-accent")}for(var[key,value]of Object.entries(palette.color))document.body.setAttribute("data-md-color-"+key,value)}</script>
    
    
    
      
      
        <label class="md-header__button md-icon" for="__search">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        </label>
        <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" title="Clear" aria-label="Clear" tabindex="-1">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/></svg>
        </button>
      </nav>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" tabindex="0" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
      
    
    
  </nav>
  
    
      
<nav class="md-tabs" aria-label="Tabs" data-md-component="tabs">
  <div class="md-grid">
    <ul class="md-tabs__list">
      
        
  
  
  
  
    <li class="md-tabs__item">
      <a href=".." class="md-tabs__link">
        
  
  
    
  
  Home

      </a>
    </li>
  

      
        
  
  
  
    
  
  
    
    
      
  
  
  
    
  
  
    
    
      <li class="md-tabs__item md-tabs__item--active">
        <a href="../lecture1/" class="md-tabs__link">
          
  
  
  Course

        </a>
      </li>
    
  

    
  

      
        
  
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../annex/bash_cheatsheet/" class="md-tabs__link">
          
  
  
  Annex

        </a>
      </li>
    
  

      
    </ul>
  </div>
</nav>
    
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    


  


  

<nav class="md-nav md-nav--primary md-nav--lifted md-nav--integrated" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href=".." title="GLHPC - Génie Logiciel pour le Calcul Haute Performance et l&#39;Intelligence Artificielle" class="md-nav__button md-logo" aria-label="GLHPC - Génie Logiciel pour le Calcul Haute Performance et l'Intelligence Artificielle" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54"/></svg>

    </a>
    GLHPC - Génie Logiciel pour le Calcul Haute Performance et l'Intelligence Artificielle
  </label>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href=".." class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Home
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
    
  
  
  
    
    
    
    
      
        
        
      
      
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--section md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2" checked>
        
          
          <label class="md-nav__link" for="__nav_2" id="__nav_2_label" tabindex="">
            
  
  
  <span class="md-ellipsis">
    Course
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_2_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_2">
            <span class="md-nav__icon md-icon"></span>
            Course
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_2_1" >
        
          
          <label class="md-nav__link" for="__nav_2_1" id="__nav_2_1_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    Lectures
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_2_1_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2_1">
            <span class="md-nav__icon md-icon"></span>
            Lectures
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../lecture1/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    L1 - Introduction to Software Engineering for HPC/AI, Development Environment
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../lecture2/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    L2 - Performance Aware C Computing
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../lecture3/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    L3 - Building, Testing, and Debugging Scientific Software
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../lecture4/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    L4 - Experimental Design, Profiling, and Performance/Energy Optimization
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../lecture5/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    L5 - HPC for AI & Environmental Impact of Computation
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
    
  
  
  
    
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2_2" checked>
        
          
          <label class="md-nav__link" for="__nav_2_2" id="__nav_2_2_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    Labs
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_2_2_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_2_2">
            <span class="md-nav__icon md-icon"></span>
            Labs
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../lab1/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Lab 1 - Prerequisites
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../lab2/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Lab 2 - C Programming and Memory Management
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../lab3/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Lab 3 - CMake, Unit Tests, and Debugging
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../lab4/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Lab 4 - Monte-Carlo sampling
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
    
  
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
      
      
      <a href="./" class="md-nav__link md-nav__link--active">
        
  
  
  <span class="md-ellipsis">
    Lab 5 - Experimental Methodology and Scientific Reporting
    
  </span>
  

      </a>
      
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../lab6/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Lab 6 - AI Project (1) SGEMM Kernel Optimization
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../lab7/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Lab 7 - AI Project (2) Neural Network Inference
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_3" >
        
          
          <label class="md-nav__link" for="__nav_3" id="__nav_3_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    Annex
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_3_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3">
            <span class="md-nav__icon md-icon"></span>
            Annex
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../annex/bash_cheatsheet/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Bash cheatsheet
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_3_2" >
        
          
          <label class="md-nav__link" for="__nav_3_2" id="__nav_3_2_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    Linux Environment
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_3_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3_2">
            <span class="md-nav__icon md-icon"></span>
            Linux Environment
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../annex/install_fedora/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Installing fedora
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../annex/oh-my-zsh/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Installing oh-my-zsh
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset">
                
                  



<h1 id="lab-5-experimental-methodology-and-scientific-reporting">Lab 5: Experimental Methodology and Scientific Reporting<a class="headerlink" href="#lab-5-experimental-methodology-and-scientific-reporting" title="Permanent link">&para;</a></h1>
<hr class="gradient" />

<p>The <a href="https://en.wikipedia.org/wiki/Kepler_space_telescope">Kepler space telescope</a> monitors the variation in the luminosity of distant stars using a photometer. The datasets are freely available online, and we will use them as a study case for this lab.</p>
<figure>
  <img alt="Processing Example" src="../image/lab5/kepler.png" />
<br />
<figcaption>Kepler space telescope shortly after the assembly
  <br>
  (NASA/Troy Cryder)
  </figcaption>
</figure>
<p>Kepler generates pretty simple datasets: a photon flux (the intensity of the received light) at a certain date for a particular star. However, by carefully preprocessing this data and using dedicated signal analysis techniques, we can make major discoveries.</p>
<hr />
<h3 id="provided-files">Provided files<a class="headerlink" href="#provided-files" title="Permanent link">&para;</a></h3>
<table>
<thead>
<tr>
<th>Path</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>data/</code></td>
<td>Pre-processed Kepler dataset for this lab</td>
</tr>
<tr>
<td><code>libbls/</code></td>
<td>Box Least Square (BLS) Python library for transit detection. (CMake)</td>
</tr>
<tr>
<td><code>scripts/</code></td>
<td>Python/bash scripts for plotting and data analysis</td>
</tr>
<tr>
<td><code>scripts/stability.py</code></td>
<td>Monitors the system usage for 5 minutes to assess measurements stability</td>
</tr>
<tr>
<td><code>scripts/strong_scaling.py</code></td>
<td>Draft for a strong scaling analysis you will have to complete</td>
</tr>
<tr>
<td><code>setup_env.sh</code></td>
<td>Helper script to setup the python environment and various env. variables</td>
</tr>
<tr>
<td><code>build_library.sh</code></td>
<td>Helper script to run CMake for the BLS library</td>
</tr>
</tbody>
</table>
<hr class="gradient" />

<h2 id="1-plotting-and-data-analysis">1 - Plotting and data analysis<a class="headerlink" href="#1-plotting-and-data-analysis" title="Permanent link">&para;</a></h2>
<p>Kepler generates time-series, that is data indexed by a timestep. First, look at the data inside <code>data/Kepler-8_light_curve.csv</code>. The <code>time</code> column denotes the time in days since the satellite reference. The <code>flux</code> column is the normalized measured luminosity of the Kepler 8 star at a given date.</p>
<h4 id="a-setup-python">a) Setup python<a class="headerlink" href="#a-setup-python" title="Permanent link">&para;</a></h4>
<p>Run the following:
<div class="language-bash highlight"><span class="filename">Setup bash environment</span><pre><span></span><code><span id="__span-0-1"><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="nb">source</span><span class="w"> </span>./setup_env.sh
</span></code></pre></div></p>
<h4 id="b-plot-the-evolution-of-luminosity">b) Plot the evolution of luminosity<a class="headerlink" href="#b-plot-the-evolution-of-luminosity" title="Permanent link">&para;</a></h4>
<p>Write a <code>scripts/plot_luminosity.py</code> script that:</p>
<ul>
<li>Can be called with <code>./scripts/plot_luminosity.py ./results kepler-*</code> where * is an id (i.e., kepler-8, kepler-17, etc.)</li>
<li>Fetches the corresponding dataset in <code>data/</code></li>
<li>Plots the dataset using <code>matplotlib</code> (x: Time (days), y: Flux)</li>
<li>Save the plots as <code>results/luminosity_kepler-*.png</code></li>
</ul>
<p>Make sure that the script is executable using <code>chmod +x &lt;file&gt;</code> and that the file starts with the shebang <code>#!/usr/bin/env python3</code> </p>
<div class="admonition tip">
<p class="admonition-title">Tip</p>
<p>You should make sure that the <code>results</code> folder exists before trying to save to it. You can use <code>os.makedirs(&lt;path&gt;, exists_ok=True)</code> in your script. Beware that the datasets paths are Capitalized !</p>
</div>
<h4 id="c-run-the-previous-script-for-the-kepler-8-dataset-what-do-you-observe">c) Run the previous script for the Kepler 8 dataset. What do you observe ?<a class="headerlink" href="#c-run-the-previous-script-for-the-kepler-8-dataset-what-do-you-observe" title="Permanent link">&para;</a></h4>
<h4 id="d-refine-your-previous-plot">d) Refine your previous plot<a class="headerlink" href="#d-refine-your-previous-plot" title="Permanent link">&para;</a></h4>
<p>Make sure that:</p>
<ul>
<li>The axis are clearly labelled</li>
<li>The x and y ticks are easily readable and properly spaced (<code>np.linspace</code>)</li>
<li>The plot has a title, legend, and a <code>tight</code> or <code>constrained</code> layout.</li>
<li>The figure format is correct (ratio between width and height)</li>
</ul>
<p>The final plot should look something like this:</p>
<figure>
  <img src="/image/lab5/luminosity_Kepler-8.png" style="max-width: 100%; width: auto;">
<br />
<figcaption>Kepler 8 Light curve
  </figcaption>
</figure>
<h4 id="e-give-a-possible-explanation-for-the-periodic-dips-in-luminosity">e) Give a possible explanation for the periodic dips in luminosity<a class="headerlink" href="#e-give-a-possible-explanation-for-the-periodic-dips-in-luminosity" title="Permanent link">&para;</a></h4>
<p>On the previous light curve, we observe that the luminosity appears to "dip" sharply at regular intervals.
What could cause this periodic phenomenon ?</p>
<h4 id="f-implement-phase-folding-light-curve">f) Implement phase folding light curve<a class="headerlink" href="#f-implement-phase-folding-light-curve" title="Permanent link">&para;</a></h4>
<p>Phase folding is a simple technique to visualize periodic signals: we fold the data over a given period so that the signals overlaps, highlighting patterns.</p>
<div class="language-python highlight"><span class="filename">Phase Folding</span><pre><span></span><code><span id="__span-1-1"><a id="__codelineno-1-1" name="__codelineno-1-1" href="#__codelineno-1-1"></a><span class="c1"># ... Load data here</span>
</span><span id="__span-1-2"><a id="__codelineno-1-2" name="__codelineno-1-2" href="#__codelineno-1-2"></a><span class="c1"># Period to fold over</span>
</span><span id="__span-1-3"><a id="__codelineno-1-3" name="__codelineno-1-3" href="#__codelineno-1-3"></a><span class="n">period</span> <span class="o">=</span> <span class="mf">0.8</span>
</span><span id="__span-1-4"><a id="__codelineno-1-4" name="__codelineno-1-4" href="#__codelineno-1-4"></a> <span class="c1"># We phase by the period, and divide by period to go in the [0, 1] range</span>
</span><span id="__span-1-5"><a id="__codelineno-1-5" name="__codelineno-1-5" href="#__codelineno-1-5"></a><span class="n">phase</span> <span class="o">=</span> <span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="s2">&quot;time&quot;</span><span class="p">]</span> <span class="o">%</span> <span class="n">period</span><span class="p">)</span> <span class="o">/</span> <span class="n">period</span>
</span><span id="__span-1-6"><a id="__codelineno-1-6" name="__codelineno-1-6" href="#__codelineno-1-6"></a><span class="n">phase</span> <span class="o">=</span> <span class="n">phase</span> <span class="o">-</span> <span class="mf">0.5</span> <span class="c1"># Center the phase</span>
</span><span id="__span-1-7"><a id="__codelineno-1-7" name="__codelineno-1-7" href="#__codelineno-1-7"></a><span class="n">sort_idx</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">argsort</span><span class="p">(</span><span class="n">phase</span><span class="p">)</span>
</span><span id="__span-1-8"><a id="__codelineno-1-8" name="__codelineno-1-8" href="#__codelineno-1-8"></a><span class="n">phase_sorted</span> <span class="o">=</span> <span class="n">phase</span><span class="p">[</span><span class="n">sort_idx</span><span class="p">]</span>
</span><span id="__span-1-9"><a id="__codelineno-1-9" name="__codelineno-1-9" href="#__codelineno-1-9"></a><span class="n">flux_sorted</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="s2">&quot;flux&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="n">sort_idx</span><span class="p">]</span>
</span><span id="__span-1-10"><a id="__codelineno-1-10" name="__codelineno-1-10" href="#__codelineno-1-10"></a>
</span><span id="__span-1-11"><a id="__codelineno-1-11" name="__codelineno-1-11" href="#__codelineno-1-11"></a><span class="n">phase</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">concatenate</span><span class="p">([</span><span class="n">phase_sorted</span><span class="p">,</span> <span class="n">phase_sorted</span><span class="o">+</span><span class="mi">1</span><span class="p">])</span> <span class="c1"># Double plotting to improve visualization</span>
</span><span id="__span-1-12"><a id="__codelineno-1-12" name="__codelineno-1-12" href="#__codelineno-1-12"></a><span class="n">flux</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">concatenate</span><span class="p">([</span><span class="n">flux_sorted</span><span class="p">,</span> <span class="n">flux_sorted</span><span class="p">])</span>
</span></code></pre></div>
<p>Implement a <code>scripts/phase_folding.py</code> script that plots the phase-folded light curve (x: phase, y: flux). </p>
<p>It should be used like so:
<code>./scripts/phase_folding.py ./results kepler-* &lt;period&gt;</code>.</p>
<p>Optionally, you can also plot a binned mean on top of the phase-folded light curve:</p>
<div class="language-python highlight"><span class="filename">Phase folding: Binning</span><pre><span></span><code><span id="__span-2-1"><a id="__codelineno-2-1" name="__codelineno-2-1" href="#__codelineno-2-1"></a><span class="kn">from</span><span class="w"> </span><span class="nn">scipy</span><span class="w"> </span><span class="kn">import</span> <span class="n">stats</span>
</span><span id="__span-2-2"><a id="__codelineno-2-2" name="__codelineno-2-2" href="#__codelineno-2-2"></a><span class="n">bins</span> <span class="o">=</span> <span class="mi">200</span>
</span><span id="__span-2-3"><a id="__codelineno-2-3" name="__codelineno-2-3" href="#__codelineno-2-3"></a><span class="n">bin_means</span><span class="p">,</span> <span class="n">bin_edges</span><span class="p">,</span> <span class="n">_</span> <span class="o">=</span> <span class="n">stats</span><span class="o">.</span><span class="n">binned_statistic</span><span class="p">(</span><span class="n">phase_sorted</span><span class="p">,</span> <span class="n">flux_sorted</span><span class="p">,</span> <span class="n">statistic</span><span class="o">=</span><span class="s1">&#39;mean&#39;</span><span class="p">,</span> <span class="n">bins</span><span class="o">=</span><span class="n">bins</span><span class="p">)</span>
</span><span id="__span-2-4"><a id="__codelineno-2-4" name="__codelineno-2-4" href="#__codelineno-2-4"></a><span class="n">bin_centers</span> <span class="o">=</span> <span class="p">(</span><span class="n">bin_edges</span><span class="p">[:</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="n">bin_edges</span><span class="p">[</span><span class="mi">1</span><span class="p">:])</span> <span class="o">/</span> <span class="mi">2</span>
</span><span id="__span-2-5"><a id="__codelineno-2-5" name="__codelineno-2-5" href="#__codelineno-2-5"></a><span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">bin_centers</span><span class="p">,</span> <span class="n">bin_means</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;red&quot;</span><span class="p">,</span> <span class="n">lw</span><span class="o">=</span><span class="mf">1.5</span><span class="p">)</span>
</span></code></pre></div>
<h4 id="h-check-the-file-datakepler-8_known_planetsjson">h) Check the file `data/Kepler-8_known_planets.json<a class="headerlink" href="#h-check-the-file-datakepler-8_known_planetsjson" title="Permanent link">&para;</a></h4>
<p>Run the previous script by phase folding over the Kepler 8b Period. </p>
<ul>
<li>What do you observe ? </li>
<li>Does the light "dip" overlaps or is your plot noisy ? </li>
<li>What can we say about the relationship between the light "dip" and Kepler 8b orbit ?</li>
</ul>
<figure>
  <img src="/image/lab5/phase_folding_Kepler-8.png" style="max-width: 100%; width: auto;">
<br />
<figcaption>Phase folded Kepler 8 Light curve
  </figcaption>
</figure>
<hr class="gradient" />

<h2 id="2-box-least-square">2 - Box Least Square<a class="headerlink" href="#2-box-least-square" title="Permanent link">&para;</a></h2>
<p>The Box Least Square (BLS) signal processing algorithm is used to detect the transit of exoplanets in front of their stars by searching for characteristic box-shaped dips in the luminosity at regular frequency.</p>
<p>The provided library implements a Python &lt;-&gt; C interface so that you can call BLS from a python script. It also simplifies the loading and manipulation of the data, which can be done in python, while the C code focuses on the high performance analysis.</p>
<h4 id="a-run-the-provided-build_librarysh-script">a) Run the provided <code>build_library.sh</code> script<a class="headerlink" href="#a-run-the-provided-build_librarysh-script" title="Permanent link">&para;</a></h4>
<h4 id="b-write-a-scriptsbls_runnerpy-script-for-kepler-data">b) Write a <code>scripts/bls_runner.py</code> script for kepler data<a class="headerlink" href="#b-write-a-scriptsbls_runnerpy-script-for-kepler-data" title="Permanent link">&para;</a></h4>
<p>The BLS library can be used like so:
<div class="language-python highlight"><pre><span></span><code><span id="__span-3-1"><a id="__codelineno-3-1" name="__codelineno-3-1" href="#__codelineno-3-1"></a><span class="kn">import</span><span class="w"> </span><span class="nn">bls</span>
</span><span id="__span-3-2"><a id="__codelineno-3-2" name="__codelineno-3-2" href="#__codelineno-3-2"></a><span class="c1"># ... Load data here</span>
</span><span id="__span-3-3"><a id="__codelineno-3-3" name="__codelineno-3-3" href="#__codelineno-3-3"></a><span class="n">match</span> <span class="o">=</span> <span class="n">bls</span><span class="o">.</span><span class="n">bls</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="s2">&quot;time&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">float64</span><span class="p">),</span> <span class="n">data</span><span class="p">[</span><span class="s2">&quot;flux&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">float64</span><span class="p">),</span>
</span><span id="__span-3-4"><a id="__codelineno-3-4" name="__codelineno-3-4" href="#__codelineno-3-4"></a>    <span class="mf">1.0</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">250</span><span class="p">,</span> <span class="mf">0.02</span><span class="p">,</span> <span class="mf">0.15</span><span class="p">,</span> <span class="mi">100</span><span class="p">)</span>
</span></code></pre></div>
BLS is very sensible to the hyperparameters, and as such you <strong>must use the ones provided here</strong>.</p>
<p>Make sure that your script can be called with <code>scripts/run_bls.py kepler-*</code> and that it reports the match found.
Check that the BLS output is coherent for the Kepler 8b exoplanet characteristic.</p>
<figure>
  <img src="/image/lab5/kepler_principle.png" style="max-width: 70%; width: auto;">
<br />
<figcaption>Principle behind the Kepler exoplanet detection system
  <br>
  Hannah R. Wakeford, Laura C. Mayorga
  <br>
  <a href="https://arxiv.org/abs/2506.22839">Characterizing the Dynamics and Chemistry of Transiting Exoplanets with the Habitable World Observatory (2025)</a>
  </figcaption>
</figure>
<hr class="gradient" />

<h2 id="3-profiling-for-energy-and-performance-characterization">3 - Profiling for energy and performance characterization<a class="headerlink" href="#3-profiling-for-energy-and-performance-characterization" title="Permanent link">&para;</a></h2>
<h3 id="1-measuring-energy">1. Measuring Energy<a class="headerlink" href="#1-measuring-energy" title="Permanent link">&para;</a></h3>
<h4 id="a-disable-perf-event-paranoid">a) Disable perf event paranoid<a class="headerlink" href="#a-disable-perf-event-paranoid" title="Permanent link">&para;</a></h4>
<p>By default, the linux kernel will restrict access to some perf counters to prevent malicious usage.
We can disable these securities by running:</p>
<div class="language-bash highlight"><pre><span></span><code><span id="__span-4-1"><a id="__codelineno-4-1" name="__codelineno-4-1" href="#__codelineno-4-1"></a>sudo<span class="w"> </span>sh<span class="w"> </span>-c<span class="w"> </span><span class="s1">&#39;echo -1 &gt; /proc/sys/kernel/perf_event_paranoid&#39;</span>
</span></code></pre></div>
<p>Run this command now.</p>
<h4 id="b-first-energy-measure">b) First energy measure<a class="headerlink" href="#b-first-energy-measure" title="Permanent link">&para;</a></h4>
<p>What does the following command do ?
<div class="language-sh highlight"><span class="filename">Idle Energy Consumption</span><pre><span></span><code><span id="__span-5-1"><a id="__codelineno-5-1" name="__codelineno-5-1" href="#__codelineno-5-1"></a>perf<span class="w"> </span>stat<span class="w"> </span>-a<span class="w"> </span>-j<span class="w"> </span>-e<span class="w"> </span>power/energy-pkg/,power/energy-cores/<span class="w"> </span>sleep<span class="w"> </span><span class="m">60</span>
</span></code></pre></div></p>
<p>Ensure your machine is mostly idle and execute this command.</p>
<h4 id="c-what-does-energy-pkg-measure-and-whats-the-unit-what-about-the-other-events">c) What does <code>energy-pkg</code> measure, and what's the unit ? What about the other events ?<a class="headerlink" href="#c-what-does-energy-pkg-measure-and-whats-the-unit-what-about-the-other-events" title="Permanent link">&para;</a></h4>
<p>Compute your machine idle power consumption: </p>
<div class="arithmatex">\[
P_{idle} = \frac{\text{energy-pkg}_{idle}}{t}
\]</div>
<h4 id="b-measure-the-bls-algorithm-energy-consumption">b) Measure the BLS algorithm energy consumption<a class="headerlink" href="#b-measure-the-bls-algorithm-energy-consumption" title="Permanent link">&para;</a></h4>
<div class="language-sh highlight"><span class="filename">Workload Consumption</span><pre><span></span><code><span id="__span-6-1"><a id="__codelineno-6-1" name="__codelineno-6-1" href="#__codelineno-6-1"></a><span class="nb">time</span><span class="w"> </span>perf<span class="w"> </span>stat<span class="w"> </span>-r<span class="w"> </span><span class="m">5</span><span class="w"> </span>-a<span class="w"> </span>-j<span class="w"> </span>-e<span class="w"> </span>power/energy-pkg/,power/energy-cores/<span class="w"> </span><span class="se">\</span>
</span><span id="__span-6-2"><a id="__codelineno-6-2" name="__codelineno-6-2" href="#__codelineno-6-2"></a><span class="w">    </span>./scripts/run_bls.py<span class="w"> </span>kepler-8
</span></code></pre></div>
<p>Note that the <code>-r 5</code> flag causes <code>perf</code> to perform 5 meta-repetitions. The <code>time</code> command reports the sum of the timings for all runs.
Compute the effective power and energy consumption of BLS.</p>
<div class="arithmatex">\[
P_{effective} = \frac{\mathrm{energy-pkg_{BLS}}}{t_{BLS}} - P_{idle}
\]</div>
<hr />
<h3 id="2-measuring-performance-metrics">2. Measuring performance metrics<a class="headerlink" href="#2-measuring-performance-metrics" title="Permanent link">&para;</a></h3>
<p>What does the following command do ?
<div class="language-sh highlight"><span class="filename">Measuring performance</span><pre><span></span><code><span id="__span-7-1"><a id="__codelineno-7-1" name="__codelineno-7-1" href="#__codelineno-7-1"></a><span class="nb">time</span><span class="w"> </span>perf<span class="w"> </span>stat<span class="w"> </span>-r<span class="w"> </span><span class="m">5</span><span class="w"> </span>-e<span class="w"> </span>instructions,cycles,cache-references,cache-misses<span class="w"> </span><span class="se">\</span>
</span><span id="__span-7-2"><a id="__codelineno-7-2" name="__codelineno-7-2" href="#__codelineno-7-2"></a><span class="w">    </span>./scripts/run_bls.py<span class="w"> </span>kepler-8
</span></code></pre></div></p>
<p>Execute this command and answer the following questions.</p>
<h4 id="a-whats-the-observed-variance-in-the-execution-time">a) What's the observed variance in the execution time ?<a class="headerlink" href="#a-whats-the-observed-variance-in-the-execution-time" title="Permanent link">&para;</a></h4>
<h4 id="b-whats-the-mean-instructions-cycle">b) What's the mean instructions / cycle ?<a class="headerlink" href="#b-whats-the-mean-instructions-cycle" title="Permanent link">&para;</a></h4>
<h4 id="c-is-the-application-compute-or-memory-intensive">c) Is the application compute or memory intensive ?<a class="headerlink" href="#c-is-the-application-compute-or-memory-intensive" title="Permanent link">&para;</a></h4>
<p>Put simply:</p>
<ul>
<li>Memory intensive application have relatively low instructions / cycles, and high memory metrics.</li>
<li>Compute intensive applications are vectorized (High intructions / cycles) and threads are fully used.
  Memory usage is relatively low because the arithmetic density is high.</li>
</ul>
<h4 id="d-what-is-costlier-running-the-bls-algorithm-or-loading-the-dataset">d) What is costlier: running the BLS algorithm, or loading the dataset ?<a class="headerlink" href="#d-what-is-costlier-running-the-bls-algorithm-or-loading-the-dataset" title="Permanent link">&para;</a></h4>
<p>Run the following:
<div class="language-sh highlight"><span class="filename">Perf Record</span><pre><span></span><code><span id="__span-8-1"><a id="__codelineno-8-1" name="__codelineno-8-1" href="#__codelineno-8-1"></a>perf<span class="w"> </span>record<span class="w"> </span>-g<span class="w"> </span>--<span class="w"> </span>python3<span class="w"> </span>./scripts/run_bls.py<span class="w"> </span>kepler-8
</span><span id="__span-8-2"><a id="__codelineno-8-2" name="__codelineno-8-2" href="#__codelineno-8-2"></a>perf<span class="w"> </span>report
</span></code></pre></div></p>
<p>You can move around the perf report using the arrow keys, and you can press <code>+</code> to expand a particular call tree.</p>
<p>How much time is spent in the BLS algorithm ?</p>
<p>What would be more time-efficient for an engineer: optimizing the data loading process, or the BLS algorithm ?</p>
<h4 id="e-build-a-flamegraph-for-bls">e) Build a flamegraph for bls<a class="headerlink" href="#e-build-a-flamegraph-for-bls" title="Permanent link">&para;</a></h4>
<p>Run the following
<div class="language-sh highlight"><span class="filename">Flamegraph</span><pre><span></span><code><span id="__span-9-1"><a id="__codelineno-9-1" name="__codelineno-9-1" href="#__codelineno-9-1"></a><span class="c1"># Download the flame graph toolsuit</span>
</span><span id="__span-9-2"><a id="__codelineno-9-2" name="__codelineno-9-2" href="#__codelineno-9-2"></a>git<span class="w"> </span>clone<span class="w"> </span>https://github.com/brendangregg/FlameGraph
</span><span id="__span-9-3"><a id="__codelineno-9-3" name="__codelineno-9-3" href="#__codelineno-9-3"></a><span class="c1"># Convert perf output to a flamegraph-readable format</span>
</span><span id="__span-9-4"><a id="__codelineno-9-4" name="__codelineno-9-4" href="#__codelineno-9-4"></a>perf<span class="w"> </span>script<span class="w"> </span>&gt;<span class="w"> </span>out.perf
</span><span id="__span-9-5"><a id="__codelineno-9-5" name="__codelineno-9-5" href="#__codelineno-9-5"></a>
</span><span id="__span-9-6"><a id="__codelineno-9-6" name="__codelineno-9-6" href="#__codelineno-9-6"></a><span class="c1"># Preprocess the perf data</span>
</span><span id="__span-9-7"><a id="__codelineno-9-7" name="__codelineno-9-7" href="#__codelineno-9-7"></a>./FlameGraph/stackcollapse-perf.pl<span class="w"> </span>./out.perf<span class="w"> </span>&gt;<span class="w"> </span>out.folded
</span><span id="__span-9-8"><a id="__codelineno-9-8" name="__codelineno-9-8" href="#__codelineno-9-8"></a>
</span><span id="__span-9-9"><a id="__codelineno-9-9" name="__codelineno-9-9" href="#__codelineno-9-9"></a><span class="c1"># Generate a flame graph</span>
</span><span id="__span-9-10"><a id="__codelineno-9-10" name="__codelineno-9-10" href="#__codelineno-9-10"></a>./FlameGraph/flamegraph.pl<span class="w"> </span>--minwidth<span class="w"> </span><span class="m">5</span><span class="w"> </span><span class="se">\</span>
</span><span id="__span-9-11"><a id="__codelineno-9-11" name="__codelineno-9-11" href="#__codelineno-9-11"></a><span class="w">    </span>--bgcolors<span class="o">=</span><span class="s2">&quot;#ffffff&quot;</span><span class="w"> </span><span class="se">\</span>
</span><span id="__span-9-12"><a id="__codelineno-9-12" name="__codelineno-9-12" href="#__codelineno-9-12"></a><span class="w">    </span>--title<span class="w"> </span><span class="s2">&quot;FlameGraph for BLS algorithm&quot;</span><span class="w"> </span>out.folded<span class="w"> </span>&gt;<span class="w"> </span>flamegraph.svg
</span></code></pre></div></p>
<p>Look at the generated <code>flamegraph.svg</code>: does the flamegraph match the previous perf result ?</p>
<hr />
<figure>
  <img src="/image/lab5/flamegraph.svg" style="max-width: 100%; width: auto;">
<br />
<figcaption>FlameGraph Example
  </figcaption>
</figure>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Its unusual to measure a python application with <code>perf</code>. We used python for this lab because it was easier to build the data analysis pipeline in python. </p>
<p>However, the same tools can be used to directly measure a C application, and precisely profile in which functions is the time spent using <code>perf record</code> and <code>perf report</code>.</p>
</div>
<h3 id="3-strong-scaling-analysis">3. Strong scaling analysis<a class="headerlink" href="#3-strong-scaling-analysis" title="Permanent link">&para;</a></h3>
<p>Take a look at <code>scripts/strong_scaling.py</code>. It contains a code snippet for running the <code>scripts/run_bls.py</code> script with a given number of threads. Our goal is now to build a strong scaling plot.</p>
<h4 id="a-look-and-try-to-understand-the-purpose-of-the-scriptsstabilitypy-script">a) Look and try to understand the purpose of the <code>scripts/stability.py</code> script<a class="headerlink" href="#a-look-and-try-to-understand-the-purpose-of-the-scriptsstabilitypy-script" title="Permanent link">&para;</a></h4>
<p>What are we measuring ? What information does this script gives us on our environment ?</p>
<h4 id="b-modify-stabilitypy-to-measure-the-stability-of-run_blspy">b) Modify <code>stability.py</code> to measure the stability of <code>run_bls.py</code><a class="headerlink" href="#b-modify-stabilitypy-to-measure-the-stability-of-run_blspy" title="Permanent link">&para;</a></h4>
<p>To further assess the stability of our setup, we should try to measure the distribution of multiple runs of <code>run_bls.py</code></p>
<p>Modify the script to:</p>
<ul>
<li>Load the kepler 8 Dataset, and subsample it (Reduce the size to ~2k randomly selected samples)</li>
<li>Save the previous script, and execute <code>run_bls.py</code> on the subsampled dataset, measuring the time.</li>
<li>Repeat the previous measurements ~100 time, and generate a distribution plot using seaborn. 
    You can use a boxplot, kdeplot, violin plot, histogram, etc.
    Save the raw data to <code>results/stability_bls.csv</code></li>
</ul>
<p>If your machine is stable, we would expect the performance distribution to follow a normal distribution.</p>
<div class="admonition danger">
<p class="admonition-title">Danger</p>
<p>Make sure to sort the dataset after subsampling by using <code>df.sort_values(by="time")</code> !</p>
</div>
<hr />
<figure>
  <img src="/image/lab5/bls_stability.png" style="max-width:80%; width: auto;">
<br />
<figcaption>Examples of different distribution plots.
  <br>
  The stability results here were gathered on a laptop that was in-use, thus the measures are quite unstable.
  </figcaption>
</figure>
<hr />
<h4 id="c-modify-scriptsstrong_scalingpy-to-build-a-strong-scaling-plot">c) Modify <code>scripts/strong_scaling.py</code> to build a strong scaling plot<a class="headerlink" href="#c-modify-scriptsstrong_scalingpy-to-build-a-strong-scaling-plot" title="Permanent link">&para;</a></h4>
<p>Save the plot to <code>results/&lt;date&gt;/strong_scaling.png</code> where date is obtained via:
<div class="language-python highlight"><span class="filename">Formatting a timestamp</span><pre><span></span><code><span id="__span-10-1"><a id="__codelineno-10-1" name="__codelineno-10-1" href="#__codelineno-10-1"></a><span class="kn">import</span><span class="w"> </span><span class="nn">time</span>
</span><span id="__span-10-2"><a id="__codelineno-10-2" name="__codelineno-10-2" href="#__codelineno-10-2"></a><span class="n">date</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">strftime</span><span class="p">(</span><span class="s2">&quot;%Y_%m_</span><span class="si">%d</span><span class="s2">-%H_%M_%S&quot;</span><span class="p">)</span> <span class="c1"># e.g. 2025_08_28-12_08_40</span>
</span><span id="__span-10-3"><a id="__codelineno-10-3" name="__codelineno-10-3" href="#__codelineno-10-3"></a><span class="n">os</span><span class="o">.</span><span class="n">makedirs</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;results/</span><span class="si">{</span><span class="n">date</span><span class="si">}</span><span class="s2">/&quot;</span><span class="p">,</span> <span class="n">exist_ok</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span></code></pre></div></p>
<hr class="gradient" />

<h2 id="4-report">4 - Report<a class="headerlink" href="#4-report" title="Permanent link">&para;</a></h2>
<p>You are tasked in making a <strong>maximum 3 page report (References not included)</strong>. Your report must use the following structure:</p>
<ul>
<li>1) Environment and context<ul>
<li>Give details on the machine you used for the experiments: CPU/Memory specifications, compiler version, python version, OS name and version, and any other details that helps characterize your setup.<ul>
<li>You can use <code>lscpu</code>, <code>free -h</code>, <code>python --version</code>, <code>gcc --version</code>, ...</li>
</ul>
</li>
<li>A brief description of the context of BLS, the kepler datasets, etc.</li>
</ul>
</li>
<li>2) Kepler result<ul>
<li>Include both a lightcurve plot and a phase-folding plot for Kepler 8.</li>
<li>The BLS algorithm scans through a range of Orbital Periods, and computes a <em>Power</em> score for each candidates. The higher the power, the better the candidate. The function <code>bls.bls_periodogram(...)</code> returns a 2D array containing all the scores, which allows us to build a <strong>Periodogram</strong>. Pairs are stored as (Power, Period).
Plot a periodogram for Kepler 8, 17, 45 and 785. <strong>You are required to use subplots</strong> so that all periodograms are on the same figure. Feel free to lookup "BLS Periodogram" online to get an idea of the target results. Check that the periodograms match the known exoplanets for all these stars.</li>
</ul>
</li>
<li>3) Profiling results<ul>
<li><strong>If your machine supports RAPL measurement</strong>: Give the approximate energy consumption of the BLS algorithm on the Kepler 8 dataset. </li>
<li><strong>If your machine does not support RAPL measurement</strong>:<ul>
<li>State it explicity in your report.</li>
<li>Try on another machine if able</li>
<li>... OR replace this experiment by a weak scaling plot if you can't get RAPL to work.</li>
</ul>
</li>
<li>Give the perf results for <code>instructions,cycles,cache-references,cache-misses</code></li>
<li>Generate stability plots using <code>./scripts/stability.py</code> and include them in the report.</li>
<li>Include the flamegraph</li>
<li>Include the strong scaling plot</li>
</ul>
</li>
</ul>
<hr class="gradient" />

<div class="summary-section box-section">
<h2 class="hidden-title" id="5-summary"> 5 - Summary<a class="headerlink" href="#5-summary" title="Permanent link">&para;</a></h2>
<p>Upon completing this fifth lab, you should know how to:</p>
<ul class="task-list">
<li class="task-list-item"><label class="task-list-control"><input type="checkbox" disabled checked/><span class="task-list-indicator"></span></label> Build simple plots using python and matplotlib</li>
<li class="task-list-item"><label class="task-list-control"><input type="checkbox" disabled checked/><span class="task-list-indicator"></span></label> Improve a plot with titles, labels, formatting</li>
<li class="task-list-item"><label class="task-list-control"><input type="checkbox" disabled checked/><span class="task-list-indicator"></span></label> Manipulate simple data formats (csv, json)</li>
<li class="task-list-item"><label class="task-list-control"><input type="checkbox" disabled checked/><span class="task-list-indicator"></span></label> Use <code>perf</code> for measuring energy and performance hardware counters</li>
<li class="task-list-item"><label class="task-list-control"><input type="checkbox" disabled checked/><span class="task-list-indicator"></span></label> Use <code>perf</code> sampling profiler to understand an application hotspots</li>
<li class="task-list-item"><label class="task-list-control"><input type="checkbox" disabled checked/><span class="task-list-indicator"></span></label> Organise a report around data analysis</li>
</ul>
</div>












                
              </article>
            </div>
          
          
  <script>var tabs=__md_get("__tabs");if(Array.isArray(tabs))e:for(var set of document.querySelectorAll(".tabbed-set")){var labels=set.querySelector(".tabbed-labels");for(var tab of tabs)for(var label of labels.getElementsByTagName("label"))if(label.innerText.trim()===tab){var input=document.getElementById(label.htmlFor);input.checked=!0;continue e}}</script>

<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
        </div>
        
      </main>
      
        <footer class="md-footer">
  
    
      
      <nav class="md-footer__inner md-grid" aria-label="Footer" >
        
          
          <a href="../lab4/" class="md-footer__link md-footer__link--prev" aria-label="Previous: Lab 4 - Monte-Carlo sampling">
            <div class="md-footer__button md-icon">
              
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"/></svg>
            </div>
            <div class="md-footer__title">
              <span class="md-footer__direction">
                Previous
              </span>
              <div class="md-ellipsis">
                Lab 4 - Monte-Carlo sampling
              </div>
            </div>
          </a>
        
        
          
          <a href="../lab6/" class="md-footer__link md-footer__link--next" aria-label="Next: Lab 6 - AI Project (1) SGEMM Kernel Optimization">
            <div class="md-footer__title">
              <span class="md-footer__direction">
                Next
              </span>
              <div class="md-ellipsis">
                Lab 6 - AI Project (1) SGEMM Kernel Optimization
              </div>
            </div>
            <div class="md-footer__button md-icon">
              
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M4 11v2h12l-5.5 5.5 1.42 1.42L19.84 12l-7.92-7.92L10.5 5.5 16 11z"/></svg>
            </div>
          </a>
        
      </nav>
    
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
    <div class="md-copyright__highlight">
      CC BY-NC 4.0; 2025 - Pablo de Oliveira Castro, Mathys E. Jam
    </div>
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
      <div class="md-progress" data-md-component="progress" role="progressbar"></div>
    
    
    
      
      <script id="__config" type="application/json">{"base": "..", "features": ["navigation.path", "navigation.instant", "navigation.instant.progress", "navigation.expand", "navigation.tracking", "navigation.tabs", "navigation.tabs.sticky", "navigation.footer", "header.autohide", "toc.integrate", "content.code.annotate", "content.tabs.link", "content.code.copy"], "search": "../assets/javascripts/workers/search.973d3a69.min.js", "tags": null, "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}, "version": null}</script>
    
    
      <script src="../assets/javascripts/bundle.92b07e13.min.js"></script>
      
        <script src="../javascripts/mathjax.js"></script>
      
        <script src="https://unpkg.com/mathjax@3/es5/tex-mml-chtml.js"></script>
      
    
  </body>
</html>